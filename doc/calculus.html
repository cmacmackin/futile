<HTML>
<HEAD>
   <TITLE> module calculus (generated by f90doc) </TITLE>
</HEAD>
<H1> Module calculus </H1>
<PRE>module calculus

        ! Subroutines and functions
    public recursive subroutine <A HREF="calculus.html#subroutine_differentiate">differentiate</A> (derivval, dxval, error, func, iter1, nderiv, tol, xval, verbose)
    public subroutine <A HREF="calculus.html#subroutine_romberg">romberg</A> (intval, error, func, iter1, left, numcalls, right, tol, verbose)

end module calculus
</PRE>
  A module containing subroutines which can perform numerical
  calculus. Currently only a couple of calculus operations are 
  available, but they should work on any function returning real(8) 
  data.
<P>
<STRONG>Author:</STRONG> Christopher MacMackin

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_differentiate"><H3>differentiate</H3></A>
<PRE>public recursive subroutine differentiate (derivval, dxval, error, func, iter1, nderiv, tol, xval, verbose)
    real (kind=8), intent(out) :: derivval
</PRE>
<DL><DD><DL><DD>
 The computed value of the derivative.
</DL></DL>
<PRE>    real (kind=8), intent(in) :: dxval
</PRE>
<DL><DD><DL><DD>
 The initial value to use for computing the finite difference.
</DL></DL>
<PRE>    real (kind=8), intent(out) :: error
</PRE>
<DL><DD><DL><DD>
 An estimate of the error in the computed derivative.
</DL></DL>
<PRE>    interface func
        real (kind=8) function func (x)
            real (kind=8), intent(in) :: x
        end function func
    end interface func
</PRE>
<DL><DD><DL><DD>
 The function for which to calculate the derivative. Must return a 
 real(8) value.
</DL></DL>
<PRE>    integer, intent(out) :: iter1
</PRE>
<DL><DD><DL><DD>
 The number of iterations required to calculate the derivative. 
</DL></DL>
<PRE>    integer, intent(in) :: nderiv
</PRE>
<DL><DD><DL><DD>
 What derivative to take.
</DL></DL>
<PRE>    real (kind=8), intent(in) :: tol
</PRE>
<DL><DD><DL><DD>
 The desired accuracy with which to compute the derivative to the 
 desired accuracy.
</DL></DL>
<PRE>    real (kind=8), intent(in) :: xval
</PRE>
<DL><DD><DL><DD>
 The value of <I>x</I> at which to calculate the derivative of function 
 <I>f</I>(<I>x</I>).
</DL></DL>
<PRE>    logical, intent(in) :: verbose
</PRE>
<DL><DD><DL><DD>
 Whether to print Richardson extrapolation tables.
</DL></DL>
<PRE>    ! Calls: rederiv
end subroutine differentiate
</PRE>
              Uses Richardson Extrapolation and finite differences to
              calculate a function's derivative to the desired precision.
              Will perform up to five iterations of Richardson 
              Extrapolation.
<P>
              Adapted from a FORTRAN77 routine by Dr. David A. Clarke. 
<A NAME="subroutine_romberg"><H3>romberg</H3></A>
<PRE>public subroutine romberg (intval, error, func, iter1, left, numcalls, right, tol, verbose)
    real (kind=8), intent(out) :: intval
</PRE>
<DL><DD><DL><DD>
 The value calculated for the definite integral.
</DL></DL>
<PRE>    real (kind=8), intent(out) :: error
</PRE>
<DL><DD><DL><DD>
 An estimate of the error in the computed integral.
</DL></DL>
<PRE>    interface func
        real (kind=8) function func (x)
            real (kind=8), intent(in) :: x
        end function func
    end interface func
</PRE>
<DL><DD><DL><DD>
 The function (returning a real(8) value) whose integral is to be 
 calculated.
</DL></DL>
<PRE>    integer, intent(out) :: iter1
</PRE>
<DL><DD><DL><DD>
 The number of iterations required to calculate the integral to the 
 desired precision.
</DL></DL>
<PRE>    real (kind=8), intent(in) :: left
</PRE>
<DL><DD><DL><DD>
 The lower limit of integration.
</DL></DL>
<PRE>    integer, intent(out) :: numcalls
</PRE>
<DL><DD><DL><DD>
 The number of function calls needed to calculate the integral to the 
 desired precision.
</DL></DL>
<PRE>    real (kind=8), intent(in) :: right
</PRE>
<DL><DD><DL><DD>
 The upper limit of integration.
</DL></DL>
<PRE>    real (kind=8), intent(in) :: tol
</PRE>
<DL><DD><DL><DD>
 The desired accuracy to which to calculate the integral.
</DL></DL>
<PRE>    logical, intent(in) :: verbose
</PRE>
<DL><DD><DL><DD>
 Indicates whether to print the Richardson  Extrapolation table for 
 the integration.
</DL></DL>
<PRE>    ! Calls: update
end subroutine romberg
</PRE>
          This subroutine computes the 1D definite integral of a
          function over the desired range and to the desired accuracy. It
          uses the technique of Romberg Integration, performing up to 10
          iterations.
</HTML>
