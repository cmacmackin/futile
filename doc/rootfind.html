<HTML>
<HEAD>
   <TITLE> module rootfind (generated by f90doc) </TITLE>
</HEAD>
<H1> Module rootfind </H1>
<PRE>module rootfind

        ! Subroutines and functions
    public subroutine <A HREF="rootfind.html#subroutine_bis_secant">bis_secant</A> (error, fnctn, maxerr, maxsteps, steps, verbose, xcur, xleft, xright)
    public subroutine <A HREF="rootfind.html#subroutine_global_bis_sec">global_bis_sec</A> (dx, error, fnctn, maxerr, maxsteps, numroots, roots, steps, verbose, xmax, xmin)
    public subroutine <A HREF="rootfind.html#subroutine_global_brackets">global_brackets</A> (brackets, dx, fnctn, numroots, verbose, xmax, xmin)

end module rootfind
</PRE>
  Provides subroutines implementing various root-finding algorithms, 
  as well as a global bracket finder.
<P>
<STRONG>Author:</STRONG> Christopher MacMackin

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_bis_secant"><H3>bis_secant</H3></A>
<PRE>public subroutine bis_secant (error, fnctn, maxerr, maxsteps, steps, verbose, xcur, xleft, xright)
    real(kind=8), intent(out) :: error
</PRE>
<DL><DD><DL><DD>
 A real variable in which an estimate of the error in the computed 
 root will be stored and returned.
</DL></DL>
<PRE>    interface fnctn
        function fnctn (x)
            real(kind=8), intent(in) :: x
            real(kind=8) :: fnctn
        end function fnctn
    end interface fnctn
</PRE>
<DL><DD><DL><DD>
 The Fortran function for which the root will be found. Must take only 
 one real argument, return a real argument.
</DL></DL>
<PRE>    real(kind=8), intent(in) :: maxerr
</PRE>
<DL><DD><DL><DD>
 A real value which specifies the the maximum allowable error in the 
 computed root. The subroutine terminates once the error passes below 
 this level. 
</DL></DL>
<PRE>    integer, intent(in) :: maxsteps
</PRE>
<DL><DD><DL><DD>
 An integer value for the maximum number of iterations applied to the  
 algorithm before terminating.
</DL></DL>
<PRE>    integer, intent(out) :: steps
</PRE>
<DL><DD><DL><DD>
 Returns the number of iterations needed before error falls below       
 maxerr (or returns maxsteps if that many iterations occur first).
</DL></DL>
<PRE>    logical, intent(in) :: verbose
</PRE>
<DL><DD><DL><DD>
 A logical variable which specifies whether to print progress to 
 stdout at each iteration. Also controls whether to print a warning 
 when maximum number of iterations reached.
</DL></DL>
<PRE>    real(kind=8), intent(out) :: xcur
</PRE>
<DL><DD><DL><DD>
 A real variable in which the computed value of the root will be   
 returned.
</DL></DL>
<PRE>    real(kind=8), intent(inout) :: xleft
</PRE>
<DL><DD><DL><DD>
 A real value specifying lower bound within which to search for root.
</DL></DL>
<PRE>    real(kind=8), intent(inout) :: xright
</PRE>
<DL><DD><DL><DD>
 A real value specifying upper bound within which to search for root.
</DL></DL>
<PRE>end subroutine bis_secant
</PRE>
  A root finder using the hybrid bisection-secant algorithm. 
  Returns a computed value of the root within xleft and xright 
  once error < maxerr or has run maximum number of 
  iterations.                                    
<A NAME="subroutine_global_bis_sec"><H3>global_bis_sec</H3></A>
<PRE>public subroutine global_bis_sec (dx, error, fnctn, maxerr, maxsteps, numroots, roots, steps, verbose, xmax, xmin)
    real(kind=8), intent(inout) :: dx
</PRE>
<DL><DD><DL><DD>
 The initial size of increment to use when examining function. 
 Minimum interval will be 0.01 of this.
</DL></DL>
<PRE>    real(kind=8), intent(out), dimension(:) :: error
</PRE>
<DL><DD><DL><DD>
 A real array in which an estimate of the error in each computed root 
 will be stored and returned. 
</DL></DL>
<PRE>    interface fnctn
        function fnctn (x)
            real(kind=8), intent(in) :: x
            real(kind=8) :: fnctn
        end function fnctn
    end interface fnctn
</PRE>
<DL><DD><DL><DD>
 The Fortran function for which the root will be found. Must take 
 only one real argument, return a real argument.
</DL></DL>
<PRE>    real(kind=8), intent(in) :: maxerr
</PRE>
<DL><DD><DL><DD>
 A real value which specifies the the maximum allowable error in the 
 computed root. The subroutine terminates once the error passes below 
 this level.
</DL></DL>
<PRE>    integer, intent(in) :: maxsteps
</PRE>
<DL><DD><DL><DD>
 An integer value for the maximum number of iterations applied to the 
 algorithm before terminating.
</DL></DL>
<PRE>    integer, intent(out) :: numroots
</PRE>
<DL><DD><DL><DD>
 An integer value which will return the number of roots for which 
 brackets were found. A negative number indicates that an error 
 occurred.
</DL></DL>
<PRE>    real(kind=8), intent(out), dimension(:) :: roots
</PRE>
<DL><DD><DL><DD>
 A real array in which the computed values of each root will be 
 returned.
</DL></DL>
<PRE>    integer, intent(out), dimension(:) :: steps
</PRE>
<DL><DD><DL><DD>
 An integer array in which the number of iterations needed before 
 error falls below maxerr for each root is stored and returned.
</DL></DL>
<PRE>    logical, intent(in) :: verbose
</PRE>
<DL><DD><DL><DD>
 A logical variable which specifies whether to print progress to 
 stdout as brackets found and at each iteration as root found. Also 
 says whether to print a warning if 'dx' set to 'dxmin' during 
 'globrack' routine and if maximum number of iterations reached while 
 finding root.
</DL></DL>
<PRE>    real(kind=8), intent(in) :: xmax
</PRE>
<DL><DD><DL><DD>
 The upper limit of the range on which the subroutine will search for
 roots and brackets.
</DL></DL>
<PRE>    real(kind=8), intent(in) :: xmin
</PRE>
<DL><DD><DL><DD>
 The lower limit of the range on which the subroutine will search for
 roots and brackets.
</DL></DL>
<PRE>    ! Calls: biscnt, globrack
end subroutine global_bis_sec
</PRE>
  A subroutine which finds the values of all roots of a function 
  (or as many as will fit into the provided arrays) within a given 
  range of values. This subroutine uses the hybrid 
  bisection-secant root-finding algorithm.
<A NAME="subroutine_global_brackets"><H3>global_brackets</H3></A>
<PRE>public subroutine global_brackets (brackets, dx, fnctn, numroots, verbose, xmax, xmin)
    real(kind=8), intent(out), dimension(:,:) :: brackets
</PRE>
<DL><DD><DL><DD>
 A 2 by n real array in which the left and right brackets will be 
 stored and returned. Will find up to n sets of brackets.
</DL></DL>
<PRE>    real(kind=8), intent(inout) :: dx
</PRE>
<DL><DD><DL><DD>
 The initial size of increment to use when examining function. 
 Minimum interval will be 0.01 of this.
</DL></DL>
<PRE>    interface fnctn
        real(kind=8) function fnctn (x)
            real(kind=8), intent(in) :: x
        end function fnctn
    end interface fnctn
</PRE>
<DL><DD><DL><DD>
The Fortran function for which the brackets will be found. Must take 
 only one real argument, return a real argument.
</DL></DL>
<PRE>    integer, intent(out) :: numroots
</PRE>
<DL><DD><DL><DD>
 An integer value which will return the number of roots for which 
 brackets were found. A negative number indicates that an error 
 occurred.
</DL></DL>
<PRE>    logical, intent(in) :: verbose
</PRE>
<DL><DD><DL><DD>
 A logical variable which specifies whether to print to stdout any 
 bracket values which are found and warning messages when 'dx' set to 
 'dxmin'.
</DL></DL>
<PRE>    real(kind=8), intent(in) :: xmax
</PRE>
<DL><DD><DL><DD>
 The upper limit of the range on which the subroutine will search for 
 roots and brackets.
</DL></DL>
<PRE>    real(kind=8), intent(in) :: xmin
</PRE>
<DL><DD><DL><DD>
 The lower limit of the range on which the subroutine will search for 
 roots and brackets.
</DL></DL>
<PRE>end subroutine global_brackets
</PRE>
  A global bracket finder. For a given function it finds values 
  on each side of each of the function's roots within a given 
  range.
</HTML>
